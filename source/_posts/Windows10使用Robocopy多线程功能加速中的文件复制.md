---
title: Windows10使用Robocopy多线程功能加速中的文件复制
tags: ["Windows"]
categories: Windows
date: 2019-04-18
grammar_cjkRuby: true
copyright: ture
---

当用户需要将文件或文件夹复制到另一个驱动器时，通常都使用（GUI 中）标准的选择、复制和粘贴操作。虽然默认的批量文件复制和移动功能在 Windows 10 操作系统中已经历经过微软多次优化，已经能够工作得很好，但当尝试传输大批量文件（特别是大量小文件）时，还是需要很长时间，速度就成了一个瓶颈。
 <!-- more -->
此时，许多精通技术的 Windows 用户都会使用 **Robocopy**（Robust File Copy，强大的文件复制），这是一个内置于 Windows 10 中的命令行工具，它提供了更多功能来帮助用户更快地将数据移动到不同的位置。

**Robocopy** 最为特殊也经常被忽略的是其支持多线程的能力，允许我们同时复制多个文件，而不像在**文件管理器**中复制文件时只能一次一个（移动多个文件时也只是列队之后一个一个移动）。

下面介绍在 Windows 10 中如何使用 **Robocopy** 的多线程副本功能来加快文件和文件夹的复制、移动传输过程。

### 如何使用Robocopy多线程特性

如果你要将 Windows 10 中的大量文件和文件夹复制到另一个驱动器，可以仿照如下步骤来实现 **Robocopy** 多线程功能以达到超快的数据复制速度：

#### 以管理员权限打开「命令提示符」

#### 执行类似如下命令进行多线程复制

```powershell
ROBOCOPY source destination [file [file]...] [options]
```
**source** :  源目录(驱动器:\路径或\\服务器\共享\路径)。
**destination** :  目标目录(驱动器:\路径或\\服务器\共享\路径)。
**file** :  要复制的文件(名称/通配符: 默认为 "*.*")。

例如：

```powershell
robocopy D:\Pictures\ E:\收藏\Pictures /S /ZB /R:5 /W:5 /V /MT:8
```

**注意**：请自行将源路径和目标路径替换成你自己的。

### Robocopy命令行用法解释

robocopy 的功能非常强大，因此其命令行开关也非常之多，下面我们只列出能够可靠、快速复制文件的常用开关。

> **/S**:  复制子目录，但不复制空的子目录。
> **/E**:  复制子目录，包括空的子目录。
> **/LEV:n**:  仅复制源目录树的前 n 层。
> **/Z**:  在可重新启动模式下复制文件。
> **/B**:  在备份模式下复制文件。
> **/ZB**:  使用可重新启动模式；如果拒绝访问，请使用备份模式。
> **/J**:   复制时使用未缓冲的 I/O (推荐在复制大文件时使用)。
> **/R:n**:  失败副本的重试次数: 默认为 1 百万。
> **/W:n**:  两次重试间的等待时间: 默认为 30 秒。
> **/TBD**:   等待定义共享名称(重试错误 67)。
> **/NP**:   无进度 – 不显示已复制的百分比。
> **/V**:  生成详细输出，同时显示跳过的文件。
> **/MOV**:   移动文件(复制后从源中删除)。
> **/MOVE**:  移动文件和目录(复制后从源中删除)。
> **/MT:32**:  使用 n 个线程进行多线程复制(默认值为 8)。必须至少为 1，但不得大于 128。

上述命令中最为重要的开关就是 /MT，它让 robocopy 能够以多线程模式进行复制传输。如果你没为 /MT设置数字，那么默认数字是 8，这意味着 Robocopy 将会同时复制 8 个文件。我个人推荐使用 8个线程，虽然可开的线程可以更多，但数字越大，所使用的系统资源和带宽就越多。

